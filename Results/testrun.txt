(base) C:\Users\kimgr\Downloads\STUDY\Master\2021\fys-stk4155\project1>python project1.py
Initiating data structure
Creating Files and Folders



################################################################################
Starting exercise1:
Checking if my code works correctly:
My MSE is:  0.0018118539915254676
My R2 score is:  0.9771449774697887

Testing against sklearn OLS:
MSE after scaling: 0.0018
R2 score after scaling 0.9771

Calculating and printing the Confidence Intervals for Beta:
Lower bound:    Beta Values:    Upper bound:
0.30643737310429475 0.36832710701595567 0.4302168409276166
7.859095344159401 8.473223017762237 9.087350691365073
3.672833084793438 4.356293681294569 5.0397542777957005
-39.49920189632504 -36.73690403106281 -33.97460616580057
-20.739338939205215 -18.202583869510207 -15.665828799815198
-13.331350342740393 -10.336133716144111 -7.34091708954783
47.104217898488685 53.228150514706165 59.352083130923646
45.387690409670284 50.31283622389398 55.23798203811768
20.43998204241126 25.654013545799597 30.868045049187934
-12.029125836799295 -5.539787036161435 0.9495517644764258
-35.04119517575112 -28.6545811599963 -22.26796714424148
-62.26430944612659 -57.28366537259535 -52.30302129906411
-18.908325009221734 -13.82549348749642 -8.742661965771106
-38.31330902960371 -33.038898451443 -27.7644878732823
20.67814622814393 27.45726244129012 34.23637865443631
0.9382073720697939 3.4431352693244923 5.948063166579191
17.281509308084487 19.47072748394258 21.65994565980067
11.494953555725388 13.799690071811268 16.104426587897148
-7.069708064646031 -4.70592916685485 -2.3421502690636693
15.702504378969607 18.083200713826386 20.463897048683165
-18.858366241197707 -16.152828255036134 -13.44729026887456





################################################################################
Starting exercise2:

Generating figure 2.11 from Hastie..
...this might take a wile... change maxPoly to speed up..

Computing bias and variance trade-off as a function of model complexity

Polynomial degree: 1
Error: 0.021719513640262547
Bias^2: 0.0216243245418354
Var: 9.518909842715075e-05
0.021719513640262547 >= 0.0216243245418354 + 9.518909842715075e-05 = 0.02171951364026255
Polynomial degree: 2
Error: 0.016024248770881756
Bias^2: 0.015897546987201045
Var: 0.00012670178368070999
0.016024248770881756 >= 0.015897546987201045 + 0.00012670178368070999 = 0.016024248770881756
Polynomial degree: 3
Error: 0.007283410978693671
Bias^2: 0.007168035050640727
Var: 0.00011537592805294534
0.007283410978693671 >= 0.007168035050640727 + 0.00011537592805294534 = 0.007283410978693673
Polynomial degree: 4
Error: 0.004609659109478296
Bias^2: 0.004529163570589982
Var: 8.049553888831393e-05
0.004609659109478296 >= 0.004529163570589982 + 8.049553888831393e-05 = 0.004609659109478296
Polynomial degree: 5
Error: 0.0019322764614450364
Bias^2: 0.0018719205247239637
Var: 6.035593672107344e-05
0.0019322764614450364 >= 0.0018719205247239637 + 6.035593672107344e-05 = 0.0019322764614450373
Polynomial degree: 6
Error: 0.00111874671115839
Bias^2: 0.0010360619392594719
Var: 8.268477189891849e-05
0.00111874671115839 >= 0.0010360619392594719 + 8.268477189891849e-05 = 0.0011187467111583903
Polynomial degree: 7
Error: 0.0005002280553411462
Bias^2: 0.0004610850661219179
Var: 3.914298921922833e-05
0.0005002280553411462 >= 0.0004610850661219179 + 3.914298921922833e-05 = 0.0005002280553411463
Polynomial degree: 8
Error: 0.00033744463903781854
Bias^2: 0.0002660692990776479
Var: 7.137533996017061e-05
0.00033744463903781854 >= 0.0002660692990776479 + 7.137533996017061e-05 = 0.00033744463903781854
Polynomial degree: 9
Error: 0.00034563673575561883
Bias^2: 0.0002726189040939183
Var: 7.301783166170045e-05
0.00034563673575561883 >= 0.0002726189040939183 + 7.301783166170045e-05 = 0.0003456367357556187


################################################################################
Starting exercise3:

Starting Cross-validation


Doing cross-validation for polynomial:  5
Average MSE calculated from OLS cross-validation:  0.0018476731569819567


################################################################################
Starting exercise4:

Starting Ridge regression

Starting bootstrap for polynomial:  1
MSE values for Ridge regression with bootstrap
[0.02250173 0.02252218 0.02252974 0.02249248 0.02248329 0.02254574
 0.02682703 0.1376792  0.23688004 0.2466195 ]
Starting bootstrap for polynomial:  2
MSE values for Ridge regression with bootstrap
[0.01585059 0.01586465 0.0158691  0.01583628 0.01591327 0.01813463
 0.02888823 0.09731923 0.23003413 0.24896761]
Starting bootstrap for polynomial:  3
MSE values for Ridge regression with bootstrap
[0.00716675 0.00715621 0.00715418 0.00710824 0.00824311 0.01480681
 0.02713066 0.07322928 0.20803022 0.23339375]
Starting bootstrap for polynomial:  4
MSE values for Ridge regression with bootstrap
[0.00376241 0.00376226 0.00385243 0.00586182 0.00822486 0.0138397
 0.02708448 0.05808563 0.18079412 0.20968392]
Starting bootstrap for polynomial:  5
MSE values for Ridge regression with bootstrap
[0.00175039 0.00180819 0.00276775 0.00450808 0.00802555 0.01386502
 0.0325403  0.07762215 0.21487227 0.24943404]
Starting bootstrap for polynomial:  6
MSE values for Ridge regression with bootstrap
[0.00122522 0.00173847 0.00253584 0.00446078 0.00781842 0.01297702
 0.02950505 0.06800197 0.1964556  0.23311427]
Starting bootstrap for polynomial:  7
MSE values for Ridge regression with bootstrap
[0.00113068 0.00123858 0.00187316 0.00346731 0.00630368 0.01027167
 0.02608851 0.06381279 0.18293889 0.22091006]
Starting bootstrap for polynomial:  8
MSE values for Ridge regression with bootstrap
[0.00081882 0.00099734 0.00163278 0.00319262 0.00610345 0.01090817
 0.02750993 0.07268745 0.19943741 0.240147  ]
Starting bootstrap for polynomial:  9
MSE values for Ridge regression with bootstrap
[0.00086446 0.00107573 0.00175227 0.00298105 0.00610581 0.01027156
 0.02387659 0.06492289 0.18001176 0.22138211]

Doing cross-validation for polynomial:  5


################################################################################
Starting exercise5:

Starting Lasso regression


Summary of regression

Minimum values for polynomial: 5 are:
Minimum MSE values for LASSO : [0.00877074] for lambda:  [0.0001]
Minimum MSE values for Ridge : [0.00250743] for lambda:  [0.0001]
Minimum MSE values for OLS :  0.0018118539915254676


################################################################################
Starting exercise6:

Starting Analysis of Real World Data

Checking if my code works correctly:
My MSE is:  0.0011311541600620965
My R2 score is:  0.28856627894650655

Testing against sklearn OLS:
MSE after scaling: 0.0011
R2 score after scaling 0.2886

Calculating and printing the Confidence Intervals for Beta:
Lower bound:    Beta Values:    Upper bound:
0.9414702273497775 0.9595266612876926 0.9775830952256077
-0.428471288063948 -0.2545466598529532 -0.08062203164195841
-0.42847129185367633 -0.2545466631131499 -0.08062203437262344
1.4935712403609513 2.199920367736868 2.906269495112785
1.4935712405810628 2.1999203679845136 2.9062694953879644
1.493571239722211 2.1999203669158827 2.906269494109554
-6.945994796716862 -5.615689621796783 -4.285384446876703
-6.945994795066047 -5.615689620412139 -4.285384445758232
-6.945994795603719 -5.615689620895223 -4.285384446186727
-6.945994796642844 -5.615689621716822 -4.2853844467907996
4.494439760991253 5.659890536885369 6.825341312779485
4.494439762006651 5.659890538108551 6.825341314210451
4.494439761219596 5.659890537218599 6.825341313217603
4.494439761750993 5.659890537817309 6.825341313883625
4.4944397615736875 5.659890537581626 6.825341313589565
-2.3633953844003504 -1.9788070544325076 -1.5942187244646648
-2.363395384399751 -1.9788070544319079 -1.594218724464065
-2.363395384194054 -1.9788070542294098 -1.5942187242647656
-2.363395384135252 -1.978807054176478 -1.5942187242177037
-2.363395384342049 -1.9788070543802128 -1.5942187244183765
-2.363395384341714 -1.978807054379878 -1.5942187244180417



...this might take a wile... change maxPoly to speed up..

Computing bias and variance trade-off as a function of model complexity

Polynomial degree: 1
Error: 0.0027902922358457403
Bias^2: 0.0027803692761007594
Var: 9.922959744979786e-06
0.0027902922358457403 >= 0.0027803692761007594 + 9.922959744979786e-06 = 0.0027902922358457394
Polynomial degree: 2
Error: 0.001278171511354131
Bias^2: 0.0012654091766120229
Var: 1.2762334742106752e-05
0.001278171511354131 >= 0.0012654091766120229 + 1.2762334742106752e-05 = 0.0012781715113541297
Polynomial degree: 3
Error: 0.0028996809787881425
Bias^2: 0.002885981676061959
Var: 1.3699302726182167e-05
0.0028996809787881425 >= 0.002885981676061959 + 1.3699302726182167e-05 = 0.002899680978788141
Polynomial degree: 4
Error: 0.002258996654510544
Bias^2: 0.002246801712024513
Var: 1.2194942486031096e-05
0.002258996654510544 >= 0.002246801712024513 + 1.2194942486031096e-05 = 0.002258996654510544
Polynomial degree: 5
Error: 0.0004750459990190011
Bias^2: 0.0004645624887083564
Var: 1.0483510310644772e-05
0.0004750459990190011 >= 0.0004645624887083564 + 1.0483510310644772e-05 = 0.00047504599901900115
Polynomial degree: 6
Error: 0.0005613925997454413
Bias^2: 0.0005506679208366948
Var: 1.0724678908746952e-05
0.0005613925997454413 >= 0.0005506679208366948 + 1.0724678908746952e-05 = 0.0005613925997454418
Polynomial degree: 7
Error: 0.00030208780492688495
Bias^2: 0.00029591295412410856
Var: 6.174850802776417e-06
0.00030208780492688495 >= 0.00029591295412410856 + 6.174850802776417e-06 = 0.000302087804926885
Polynomial degree: 8
Error: 0.0003414881401590081
Bias^2: 0.0003364811951770661
Var: 5.0069449819422935e-06
0.0003414881401590081 >= 0.0003364811951770661 + 5.0069449819422935e-06 = 0.0003414881401590084
Polynomial degree: 9
Error: 0.0003242083305930955
Bias^2: 0.00031573285000246353
Var: 8.475480590632172e-06
0.0003242083305930955 >= 0.00031573285000246353 + 8.475480590632172e-06 = 0.0003242083305930957

Doing cross-validation for polynomial:  5
Average MSE calculated from OLS cross-validation:  0.1180882914133665
Starting bootstrap for polynomial:  1
MSE values for Ridge regression with bootstrap
[0.00530672 0.00522495 0.00525832 0.0052538  0.00544972 0.0089311
 0.0937587  0.36628046 0.44477407 0.45060751]
Starting bootstrap for polynomial:  2
MSE values for Ridge regression with bootstrap
[0.00735525 0.00735588 0.00739382 0.00728433 0.00707346 0.00438078
 0.01583312 0.29572429 0.44486005 0.45769869]
Starting bootstrap for polynomial:  3
MSE values for Ridge regression with bootstrap
[0.0009484  0.0009439  0.00094189 0.00093082 0.00098694 0.00138842
 0.01499337 0.25237905 0.43481392 0.45242491]
Starting bootstrap for polynomial:  4
MSE values for Ridge regression with bootstrap
[0.00215792 0.00217645 0.0021753  0.00226363 0.00238516 0.00292941
 0.0162074  0.22472659 0.43177694 0.4536731 ]
Starting bootstrap for polynomial:  5
MSE values for Ridge regression with bootstrap
[0.00094414 0.00093611 0.00096628 0.00100287 0.00111717 0.00118856
 0.00900374 0.19752286 0.43303244 0.45992902]
Starting bootstrap for polynomial:  6
MSE values for Ridge regression with bootstrap
[4.39389393e-04 4.47796338e-04 5.00018376e-04 6.55006752e-04
 9.49399173e-04 1.40015002e-03 9.73192616e-03 1.73496708e-01
 4.18725513e-01 4.48866946e-01]
Starting bootstrap for polynomial:  7
MSE values for Ridge regression with bootstrap
[0.0031433  0.00333754 0.00358437 0.00370088 0.00412608 0.00400349
 0.00647591 0.15345239 0.41001841 0.44377117]
Starting bootstrap for polynomial:  8
MSE values for Ridge regression with bootstrap
[0.00066098 0.00070279 0.00071804 0.00078403 0.00094284 0.00121923
 0.00889907 0.15516644 0.41610771 0.45231774]
Starting bootstrap for polynomial:  9
MSE values for Ridge regression with bootstrap
[4.36623567e-04 5.74697529e-04 6.33382220e-04 6.24345251e-04
 7.48750875e-04 1.10257881e-03 9.39690084e-03 1.51794330e-01
 4.14132937e-01 4.52530344e-01]

Doing cross-validation for polynomial:  5

LASSO regression

Summary of regression

Minimum values for polynomial: 5 are:
Minimum MSE values for LASSO : [0.00099971] for lambda:  [0.0001]
Minimum MSE values for Ridge : [0.0011747] for lambda:  [0.0001]
Minimum MSE values for OLS :  0.0011311541600620965

(base) C:\Users\kimgr\Downloads\STUDY\Master\2021\fys-stk4155\project1>